## --从输入url到页面渲染都发生了什么

**从输入URL到渲染出整个页面的过程包括三个部分：**

1、DNS解析URL的过程

2、浏览器发送请求与服务器交互的过程

3、浏览器对接收到的html页面渲染的过程

**一、DNS解析URL的过程**

   DNS是 维护系统内的每个主机的IP和主机名的对应关系的管理机构。

   DNS解析的过程就是寻找哪个服务器上有请求的资源。因为ip地址不容易记忆，一般会使用URL域名（如www.baidu.com）作为网址。    DNS解析就是将**域名翻译成IP地址的过程**。

具体过程：

​    1）[浏览器缓存](https://so.csdn.net/so/search?q=浏览器缓存&spm=1001.2101.3001.7020)：浏览器会按照一定的频率 缓存DNS记录

 　2）操作系统缓存：如果浏览器缓存中找不到需要的DNS记录，就会取操作系统中找

　 3）路由缓存：路由器也有DNS缓存

　 4）ISP的DNS服务器：ISP有专门的DNS服务器应对DNS查询请求

　5）根服务器：ISP的DNS服务器找不到之后，就要向根服务器发出请求，进行递归查询

**二、浏览器与服务器交互过程**

　　1）首先浏览器利用tcp协议通过三次握手与服务器建立连接

　　http请求包括header和body。header中包括请求的方式（get和post）、请求的协议 （http、https、ftp）、请求的地址ip、缓存cookie。body中有请求的内容。

　　2）浏览器根据解析到的IP地址和端口号发起http的get请求.

　　3）服务器接收到http请求之后，开始搜索html页面，并使用http返回响应报文

　　4）若状态码为200显示响应成功，浏览器接收到返回的html页面之后，开始进行页面的渲染

**三、浏览器页面渲染过程**

　　1）浏览器根据深度遍历的方式把html节点遍历成dom 树

　　2）将css解析成CSS DOM树

　　3）将dom树和CSS DOM树构造成render渲染树

　　4）JS根据得到的render树 计算所有节点在屏幕中的位置，进行布局（回流）

　　5）遍历render树并调用硬件API绘制所有节点（重绘）

**构造render渲染树的过程**

1. 从DOM树的根节点开始遍历每个可见的节点。
2. 对于每个可见的节点，找到CSS树中的对应的规则，并且应用他们。
3. 根据每个可见的节点及其对应的样式，组合生成渲染树。

## --重绘和重排

当浏览器下载完页面所需的元素之后，会生成两棵树：DOM树和渲染树。

DOM树主要是用来表示页面的DOM结构，而渲染树主要是用来表示页面上如何进行渲染的

**重排（重构/回流/reflow）**：当渲染树中的一部分(或全部)因为元素的规模尺寸，布局，隐藏显示等改变而需要重新构建, 这就称为回流(**reflow**)。每个页面至少需要一次回流，就是在页面第一次加载的时候。

**重绘（repaint）**：当盒子的位置、大小以及其他属性，例如颜色、字体大小等都确定下来之后，浏览器便把这些元素都按照各自的属性绘制一遍，将内容呈现在页面上。重绘是指一个元素外观的改变（如颜色、背景色等）所触发的浏览器行为，浏览器会根据元素的新属性重新绘制，使元素呈现新的外观。

**重绘和重排的关系：**在回流的时候，浏览器会使渲染树中受到影响的部分失效，并重新构造这部分渲染树，完成回流后，浏览器会重新绘制受影响的部分到屏幕中，该过程称为重绘。所以，**重排必定会引发重绘，但重绘不一定会引发重排。**

**触发条件**

重排触发条件：任何页面布局和几何属性的改变都会触发重排，比如：

　　1、页面渲染初始化；(无法避免)

　　2、添加或删除可见的DOM元素；

　　3、元素位置的改变，或者使用动画；

　　4、元素尺寸的改变——大小，外边距，边框；

　　5、浏览器窗口尺寸的变化（resize事件发生时）；

　　6、填充内容的改变，比如文本的改变或图片大小改变而引起的计算值宽度和高度的改变；

　　7、读取某些元素属性

**如何避免？**

如果进行大量的重排重绘操作，会导致浏览器很慢，十分卡顿，十分影响用户体验。

**1.浏览器的优化：**浏览器在渲染的时候就已经做了渲染优化处理：**浏览器会维护1个队列，把所有会引起回流、重绘的操作放入这个队列，等队列中的操作到了一定的数量或者到了一定的时间间隔，浏览器就会flush队列，进行一个批处理。**这样就会让多次的回流、重绘变成一次回流重绘。

**2.自身的优化：**需要减少对Render Tree的操作，可以从以下几个方面着手：

（1）直接改变元素的className，而不是使用JS来依次改变元素的属性，那样会造成多次重绘；

（2）display：none；先设置元素为display：none；然后进行页面布局等操作；设置完成后将元素设置为display：block；这样的话就只引发两次重绘和重排，但**实际操作中可能会出现闪动**；

（3）不要经常访问浏览器的flush队列属性；如果一定要访问，可以利用缓存。将访问的值存储起来，接下来使用就不会再引发回流；

（4）使用cloneNode(true or false) 和 replaceChild 技术，引发一次回流和重绘；

（5）将需要多次重排的元素（需要动画表现的元素），position属性设为absolute或fixed，元素脱离了文档流，它的变化不会影响到其他元素，降低重排的代价；

（6）如果需要创建多个DOM节点，可以使用DocumentFragment创建完后一次性的加入document；

##  --浏览器内核的理解

**主要分成两部分：渲染引擎(Layout Engine或Rendering Engine)和JS引擎。**

**渲染引擎：负责取得网页的内容（HTML、XML、图像等等）、整理讯息（例如加入CSS等），以及计算网页的显示方式，然后会输出至显示器或打印机。浏览器的内核的不同对于网页的语法解释会有不同，所以渲染的效果也不相同。**
**JS引擎：解析和执行javascript来实现网页的动态效果。**

**最开始渲染引擎和JS引擎并没有区分的很明确，后来JS引擎越来越独立，内核就倾向于只指渲染引擎。**

## **--常见的浏览器内核有哪些**

**ie：trident**
**Firefox：gecko**
**opera：之前presto，现在blink**
**[safari](https://so.csdn.net/so/search?q=safari&spm=1001.2101.3001.7020)：webkit**
**Google：blink**

## --网页验证码，是为了解决什么安全问题？

答案：

- 区分用户是计算机还是人的公共全自动程序。可以防止恶意破解密码、刷票、论坛灌水
- 有效防止黑客对某一个特定注册用户用特定程序暴力破解方式进行不断的登陆尝试

## --SEO

### seo是什么

SEO，中文翻译为“搜索引擎优化”。从本质上来说，其实就是如何迎合搜索引擎的规则，使得网站在搜索结果中能有更好的排名。

简单一句话，SEO就是让网站，在搜索引擎自然排序中能尽量排在靠前的位置。

### 说一下怎么做好seo？

1. 合理的 title、description、keywords：搜索对着三项的权重逐个减小，title 值强调重点即可，重要关键词出现不要超过 2 次，而且要靠前，不同页面 title 要有所不同；description 把页面内容高度概括，长度合适，不可过分堆砌关键词，不同页面 description 有所不同；keywords 列举出重要关键词即可
2. 语义化的 HTML 代码，符合 W3C 规范：语义化代码让搜索引擎容易理解网页
3. 重要内容 HTML 代码放在最前：搜索引擎抓取 HTML 顺序是从上到下，有的搜索引擎对抓取长度有限制，保证重要内容一定会被抓取
4. 重要内容不要用 js 输出：爬虫不会执行 js 获取内容
5. 少用 iframe：搜索引擎不会抓取 iframe 中的内容
6. 非装饰性图片必须加 alt
7. 提高网站速度：网站速度是搜索引擎排序的一个重要指标

### 请描述下 SEO 中的 TDK？

答案：在 SEO 中，所谓的 TDK 其实就是 title、description、keywords 这三个标签，title 标题标签，description 描述标签，keywords 关键词标签

##  --web socket 和 web worker

web socket 和 worker 的作用：为构建高效能的web应用提供了新的参考方案。

web socket提供更高效的传输协议，web worker提供多线程提高web应用计算效率

**1.web socket**

1.web socket是一种协议，本质上和http，tcp一样。协议是用来说明数据是如何传输的,

2.web socket的前缀有两种：（1）ws://  不是加密的。 (2)wss://  是加密的。

3.浏览器通过js向服务器发出建立webSocket连接请求，建立连接后，客户端和服务器端可以通过**TCP**连接直接交换数据 ,是**解决跨域问题**的其中一种。
4.数据传输过程:websocket的数据传输形式是：frame。比如会将一条消息分为几个frame，按照先后顺序传输出去。这样做会有几个好处：

（1）大数据的传输可以分片传输，不用考虑到数据大小导致的长度标志位不足够的情况。

（2）和http的chunk一样，可以边生成数据边传递消息，即提高传输效率。

5.客户端使用web socket的语法：JavaScript。

**2.web worker**

​    Web Worker 的作用，就是为 JavaScript 创造多线程环境，允许主线程创建 Worker 线程，将一些任务分配给后者运行
Worker 线程一旦新建成功，就会始终运行，不会被主线程上的活动（比如用户点击按钮、提交表单）打断。这样有利于随时响应主线程的通信。但是，这也造成了 Worker 比较耗费资源，不应该过度使用，而且一旦使用完毕，就应该关闭。

## --渐进增强和优雅降级的区别？

- 渐进增强是针对低版本浏览器也能保证基础功能，然后对高级浏览器改进追加功能；
- 优雅降级是一开始构建完整功能，再对低版本进行兼容

## --什么是渐进式渲染

渐进式渲染是用于提高网页性能（尤其是提高用户感知的加载速度），以尽快呈现页面的技术。 

图片懒加载——页面上的图片不会一次性全部加载。当用户滚动页面到图片部分时，JavaScript 将加载并显示图像。

确定显示内容的优先级（分层次渲染）——为了尽快将页面呈现给用户，页面只包含基本的最少量的 CSS、脚本和内容，然后可以使用延迟加载脚本或监听DOMContentLoaded/load事件加载其他资源和内容。

异步加载 HTML 片段——当页面通过后台渲染时，把 HTML 拆分，通过异步请求，分块发送给浏览器。
